<decoder name="windows_dns_debug_log">
  <prematch type="pcre2">^\d{2}\.\d{2}\.\d{4} \d{2}:\d{2}:\d{2}.*\bPACKET\b</prematch>
</decoder>

<decoder name="windows_dns_debug_log">
  <parent>windows_dns_debug_log</parent>
  <regex type="pcre2">^(\d{2}\.\d{2}\.\d{4})</regex>
  <order>dnsdate</order>
</decoder>

<decoder name="windows_dns_debug_log">
  <parent>windows_dns_debug_log</parent>
  <regex type="pcre2">((?:[0-9]{1,3}\.){3}[0-9]{1,3})</regex>
  <order>srcip</order>
</decoder>

<decoder name="windows_dns_debug_log">
  <parent>windows_dns_debug_log</parent>
  <regex type="pcre2">((Snd)|(Rcv))</regex>
  <order>transmittype</order>
</decoder>

<decoder name="windows_dns_debug_log">
  <parent>windows_dns_debug_log</parent>
  <regex type="pcre2">\]\s+\w+\s+([\w\.\-]+)\s*$</regex>
  <order>dns.query</order>
</decoder>